{
  "openapi": "3.1.0",
  "info": {
    "title": "BodyDetection API",
    "description": "API for body detection, video processing, and image/video upload functionalities.",
    "version": "1.0.0"
  },
  "tags": [
    {
      "name": "Video",
      "description": "Operations related to video processing and streaming."
    },
    {
      "name": "Image",
      "description": "Operations related to image processing and detection."
    },
    {
      "name": "Upload",
      "description": "Operations related to uploading images and videos."
    },
    {
      "name": "Task",
      "description": "Operations related to task management and status tracking."
    }
  ],
  "paths": {
    "/video_feed": {
      "get": {
        "summary": "获取视频流",
        "description": "返回实时视频流数据，用于视频监控或展示。",
        "tags": [
          "Video"
        ],
        "responses": {
          "200": {
            "description": "成功返回视频流",
            "content": {
              "multipart/x-mixed-replace; boundary=frame": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          }
        }
      }
    },
    "/dehaze": {
      "post": {
        "summary": "去烟接口",
        "description": "对上传的图片或视频进行去烟处理，返回处理后的数据。",
        "tags": [
          "Image",
          "Video"
        ],
        "requestBody": {
          "description": "上传需要处理的图片或视频",
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功返回处理后的图片或视频",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "result": {
                      "type": "string",
                      "format": "binary",
                      "description": "处理后的图片或视频数据"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/detect/images": {
      "post": {
        "summary": "检测图片",
        "description": "对上传的图片进行目标检测，返回检测结果。",
        "tags": [
          "Image"
        ],
        "requestBody": {
          "description": "上传需要检测的图片",
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "image": {
                    "type": "string",
                    "format": "binary"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功返回检测结果",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detections": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "label": {
                            "type": "string",
                            "description": "检测到的目标类别"
                          },
                          "confidence": {
                            "type": "number",
                            "format": "float",
                            "description": "检测到的目标置信度"
                          },
                          "bbox": {
                            "type": "array",
                            "items": {
                              "type": "number"
                            },
                            "description": "检测到的目标边界框坐标 [x, y, width, height]"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/detect/videos": {
      "post": {
        "summary": "检测视频",
        "description": "对上传的视频进行目标检测，返回检测结果。",
        "tags": [
          "Video"
        ],
        "requestBody": {
          "description": "上传需要检测的视频",
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "video": {
                    "type": "string",
                    "format": "binary"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "成功返回检测结果",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detections": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "timestamp": {
                            "type": "number",
                            "format": "float",
                            "description": "检测到的目标的时间戳（秒）"
                          },
                          "detections": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "label": {
                                  "type": "string",
                                  "description": "检测到的目标类别"
                                },
                                "confidence": {
                                  "type": "number",
                                  "format": "float",
                                  "description": "检测到的目标置信度"
                                },
                                "bbox": {
                                  "type": "array",
                                  "items": {
                                    "type": "number"
                                  },
                                  "description": "检测到的目标边界框坐标 [x, y, width, height]"
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/upload/video": {
      "post": {
        "summary": "上传视频接口",
        "description": "上传视频文件到服务器。",
        "tags": [
          "Upload"
        ],
        "requestBody": {
          "description": "上传的视频文件",
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "video": {
                    "type": "string",
                    "format": "binary"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "视频上传成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "description": "上传结果信息"
                    },
                    "video_id": {
                      "type": "string",
                      "description": "上传视频的唯一标识"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/upload/image": {
      "post": {
        "summary": "上传图片接口",
        "description": "上传图片文件到服务器。",
        "tags": [
          "Upload"
        ],
        "requestBody": {
          "description": "上传的图片文件",
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "image": {
                    "type": "string",
                    "format": "binary"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "图片上传成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "description": "上传结果信息"
                    },
                    "image_id": {
                      "type": "string",
                      "description": "上传图片的唯一标识"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/task/status/{task_id}": {
      "get": {
        "summary": "获取任务状态",
        "description": "获取指定任务的处理状态和进度",
        "tags": [
          "Task"
        ],
        "parameters": [
          {
            "name": "task_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "任务ID"
          }
        ],
        "responses": {
          "200": {
            "description": "成功返回任务状态",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "pending",
                        "processing",
                        "completed",
                        "failed"
                      ],
                      "description": "任务状态"
                    },
                    "result": {
                      "type": "object",
                      "nullable": true,
                      "description": "任务完成时的结果"
                    },
                    "error": {
                      "type": "string",
                      "nullable": true,
                      "description": "任务失败时的错误信息"
                    },
                    "progress": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 100,
                      "description": "处理进度（百分比）"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "任务不存在",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Task not found"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/task/list": {
      "get": {
        "summary": "获取任务列表",
        "description": "获取所有任务的列表及其状态",
        "tags": [
          "Task"
        ],
        "responses": {
          "200": {
            "description": "成功返回任务列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "tasks": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "task_id": {
                            "type": "string",
                            "description": "任务ID"
                          },
                          "status": {
                            "type": "string",
                            "enum": [
                              "pending",
                              "processing",
                              "completed",
                              "failed"
                            ],
                            "description": "任务状态"
                          },
                          "progress": {
                            "type": "number",
                            "minimum": 0,
                            "maximum": 100,
                            "description": "处理进度（百分比）"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "TaskStatus": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "processing",
              "completed",
              "failed"
            ],
            "description": "任务状态"
          },
          "result": {
            "type": "object",
            "nullable": true,
            "description": "任务完成时的结果"
          },
          "error": {
            "type": "string",
            "nullable": true,
            "description": "任务失败时的错误信息"
          },
          "progress": {
            "type": "number",
            "minimum": 0,
            "maximum": 100,
            "description": "处理进度（百分比）"
          }
        }
      }
    },
    "securitySchemes": {
      "ApiKeyAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "Authorization"
      }
    }
  },
  "servers": [
    {
      "url": "http://localhost:5000",
      "description": "Development server"
    }
  ],
  "security": [
    {
      "ApiKeyAuth": []
    }
  ]
}